  <div id="practiceArea" style="margin-top:10px"></div>
<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Belajar Seru SD</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="brand">
  <div class="logo" style="font-size:2.4rem;letter-spacing:2px;display:flex;align-items:center;justify-content:center;">BS</div>
      <div>
        <div style="font-weight:700">Belajar Seru SD</div>
        <div style="font-size:12px;color:var(--muted)">Portal Materi, Latihan, & Evaluasi</div>
      </div>
    </div>
    <nav>
      <a href="#materi">Materi</a>
      <a href="#latihan" id="latihanMenu">Latihan</a>
      <a href="#kuis">Kuis</a>
    </nav>
  </header>

    <main id="content">
      <section id="home">
        <h2>Selamat Datang</h2>
        <p>Website ini dibuat untuk membantu anak SD belajar dengan cara yang menyenangkan. Yuk mulai belajar!</p>
      </section>

      <section id="materi" class="hidden">
        <h2>Materi Belajar</h2>
        <ul>
          <li>Matematika: Penjumlahan & Pengurangan</li>
          <li>IPA: Hewan dan Tumbuhan</li>
          <li>Bahasa Indonesia: Membaca & Menulis</li>
        </ul>
      </section>

      <section id="worksheet-card">
        <div id="guruWorksheet" style="display:none">
          <form id="worksheetForm" class="card" style="background:#f8f9fa;padding:12px;margin-bottom:8px">
            <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:10px">
              <div>
                <label for="worksheetSubject" class="small">Materi:</label><br>
                <select id="worksheetSubject" style="margin-top:4px">
                  <option value="math">Matematika</option>
                  <option value="indo">Bahasa Indonesia</option>
                  <option value="sci">IPA</option>
                </select>
              </div>
              <div>
                <label for="worksheetType" class="small">Tipe:</label><br>
                <select id="worksheetType" style="margin-top:4px">
                  <option value="penjumlahan">Penjumlahan</option>
                  <option value="pengurangan">Pengurangan</option>
                  <option value="bacaan">Pemahaman Bacaan</option>
                  <option value="kata">Kata & Sinonim</option>
                  <option value="ipa">Makhluk Hidup</option>
                </select>
              </div>
            </div>
            <div style="margin-bottom:10px">
              <label for="customQuestions" class="small">Soal Custom (opsional, pisahkan dengan baris baru):</label>
              <textarea id="customQuestions" rows="4" style="width:100%;margin-top:4px" placeholder="Contoh:\n1) 12 + 5 = __\n2) 7 - 3 = __"></textarea>
            </div>
            <button type="button" id="downloadWorksheet" style="width:100%;margin-top:8px">Unduh Lembar Kerja (.txt)</button>
            <button type="button" id="saveWorksheet" style="width:100%;margin-top:8px;background:#43a047;color:#fff">Simpan Lembar Kerja untuk Siswa</button>
          </form>
        </div>
        <div id="siswaWorksheet" style="display:none">
          <div class="card" style="background:#f8f9fa;padding:12px;margin-bottom:8px">
            <h3>Lembar Latihan dari Guru</h3>
            <label for="siswaSubject">Materi:</label>
            <select id="siswaSubject" style="margin-bottom:8px">
              <option value="math">Matematika</option>
              <option value="indo">Bahasa Indonesia</option>
              <option value="sci">IPA</option>
            </select>
            <label for="siswaType">Tipe:</label>
            <select id="siswaType" style="margin-bottom:8px">
              <option value="penjumlahan">Penjumlahan</option>
              <option value="pengurangan">Pengurangan</option>
              <option value="bacaan">Pemahaman Bacaan</option>
              <option value="kata">Kata & Sinonim</option>
              <option value="ipa">Makhluk Hidup</option>
            </select>
            <div id="worksheetContent">Belum ada lembar latihan yang diisi guru.</div>
            <button type="button" id="downloadWorksheetSiswa" style="width:100%;margin-top:8px">Unduh Lembar Latihan (.txt)</button>
          </div>
        </div>
      </section>
    </main>

    <section class="lessons" id="materi">
      <div>
        <h2>Materi & Modul</h2>
        <div class="lesson-list">
          <div class="lesson-item card" style="cursor:pointer;transition:.2s" data-subject="math">
            <div class="subject math" style="font-size:2rem;display:flex;align-items:center;justify-content:center;">M</div>
            <div>
              <strong>Matematika: Penjumlahan</strong>
              <div class="small">Konsep dasar, soal latihan, dan permainan pecahan.</div>
              <div style="margin-top:8px">
                <button class="mutebtn open-materi" data-subject="math">Buka Materi</button>
                <a href="https://www.google.com/search?q=materi+matematika+sd" target="_blank" style="margin-left:8px;color:#2196f3;text-decoration:underline;font-size:0.95em">Cari di Google</a>
              </div>
            </div>
          </div>
          <div class="lesson-item card" style="cursor:pointer;transition:.2s" data-subject="indo">
            <div class="subject indo" style="font-size:2rem;display:flex;align-items:center;justify-content:center;">B</div>
            <div>
              <strong>Bahasa Indonesia: Membaca</strong>
              <div class="small">Latihan membaca, kosa kata, dan latihan memahami teks.</div>
              <div style="margin-top:8px">
                <button class="mutebtn open-materi" data-subject="indo">Buka Materi</button>
                <a href="https://www.google.com/search?q=materi+bahasa+indonesia+sd" target="_blank" style="margin-left:8px;color:#2196f3;text-decoration:underline;font-size:0.95em">Cari di Google</a>
              </div>
            </div>
          </div>
          <div class="lesson-item card" style="cursor:pointer;transition:.2s" data-subject="sci">
            <div class="subject sci" style="font-size:2rem;display:flex;align-items:center;justify-content:center;">I</div>
            <div>
              <strong>IPA: Makhluk Hidup</strong>
              <div class="small">Pengertian, contoh, dan eksperimen sederhana di rumah.</div>
              <div style="margin-top:8px">
                <button class="mutebtn open-materi" data-subject="sci">Buka Materi</button>
                <a href="https://www.google.com/search?q=materi+ipa+sd" target="_blank" style="margin-left:8px;color:#2196f3;text-decoration:underline;font-size:0.95em">Cari di Google</a>
              </div>
            </div>
          </div>
        </div>
        <div id="lessonContent" style="margin-top:12px"></div>
        <div id="materiPage" style="display:none;margin-top:24px">
          <div class="card" id="materiDetail"></div>
          <form id="uploadForm" style="margin-top:18px">
            <label for="modulFile" class="small">Upload Materi Anda (PDF/TXT):</label>
            <input type="file" id="modulFile" accept=".pdf,.txt">
            <button type="submit" class="mutebtn" style="margin-left:8px">Upload</button>
            <div id="uploadStatus" class="small" style="margin-top:8px"></div>
            <div id="uploadedFiles" style="margin-top:10px"></div>
          </form>
        </div>
      </div>


    </section>


    <section id="kuis" style="margin-top:22px">
      <h2>Kuis Interaktif</h2>
      <div class="card" style="padding:18px">
        <div style="margin-bottom:12px">
          <label for="quickQuizType2" class="small">Pilih Materi:</label>
          <select id="quickQuizType2" style="margin-left:8px">
            <option value="math">Matematika</option>
            <option value="indo">Bahasa Indonesia</option>
            <option value="sci">IPA</option>
          </select>
          <button id="startQuiz2" style="margin-left:12px">Mulai Kuis</button>
        </div>
        <div id="quizBox2"></div>
      </div>
    </section>

    <footer>
      <p>© 2025 Belajar Seru SD — Dibuat untuk bahan pembelajaran siswa SD.</p>
    </footer>
  </main>

  <!-- Firebase App (core) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <!-- Firestore -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="script.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAG_HCNddKDQRGNLS785cicKMtdgQELSk0",
      authDomain: "pembelajaransd-4a215.firebaseapp.com",
      databaseURL: "https://pembelajaransd-4a215-default-rtdb.firebaseio.com",
      projectId: "pembelajaransd-4a215",
      storageBucket: "pembelajaransd-4a215.appspot.com",
      messagingSenderId: "807174313732",
      appId: "1:807174313732:web:c6f9dc5012a162d8b8e251",
      measurementId: "G-MEMD519RTV"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.addEventListener('DOMContentLoaded', function() {
      // Redirect jika belum login
      var user = localStorage.getItem('bs_user');
      if (!user) {
        window.location.href = 'register.html';
        return;
      }
      var role = JSON.parse(user).role;
      var guruArea = document.getElementById('guruWorksheet');
      var siswaArea = document.getElementById('siswaWorksheet');
      if (role === 'guru') {
        if (guruArea) guruArea.style.display = 'block';
        if (siswaArea) siswaArea.style.display = 'none';
      } else {
        if (guruArea) guruArea.style.display = 'none';
        if (siswaArea) siswaArea.style.display = 'block';
      }

      // Guru: Simpan worksheet ke Firestore
      var saveBtn = document.getElementById('saveWorksheet');
      var worksheetContent = document.getElementById('worksheetContent');
      if (saveBtn) {
        saveBtn.onclick = function() {
          var subject = document.getElementById('worksheetSubject').value;
          var type = document.getElementById('worksheetType').value;
          var custom = document.getElementById('customQuestions').value;
          var content = `Materi: ${subject}\nTipe: ${type}\n\n${custom || 'Soal otomatis oleh guru.'}`;
          db.collection("lembar_latihan").doc(subject+"_"+type).set({content})
            .then(() => {
              alert('Lembar kerja berhasil disimpan di cloud untuk siswa!');
              if (worksheetContent) worksheetContent.textContent = content;
            });
        };
      }

      // Siswa: Tampilkan worksheet dari Firestore sesuai mapel/tipe yang dipilih
      var siswaSubject = document.getElementById('siswaSubject');
      var siswaType = document.getElementById('siswaType');
      function updateSiswaWorksheet() {
        if (!worksheetContent) return;
        var subject = siswaSubject ? siswaSubject.value : 'math';
        var type = siswaType ? siswaType.value : 'penjumlahan';
        db.collection("lembar_latihan").doc(subject+"_"+type).get()
          .then(doc => {
            worksheetContent.textContent = doc.exists ? doc.data().content : 'Belum ada lembar latihan yang diisi guru.';
          });
      }
      if (siswaSubject) siswaSubject.onchange = updateSiswaWorksheet;
      if (siswaType) siswaType.onchange = updateSiswaWorksheet;
      updateSiswaWorksheet();

      // Siswa: Download worksheet dari Firestore sesuai mapel/tipe yang dipilih
      var dwSiswaBtn = document.getElementById('downloadWorksheetSiswa');
      if (dwSiswaBtn) {
        dwSiswaBtn.onclick = function() {
          var subject = siswaSubject ? siswaSubject.value : 'math';
          var type = siswaType ? siswaType.value : 'penjumlahan';
          db.collection("lembar_latihan").doc(subject+"_"+type).get()
            .then(doc => {
              if (!doc.exists) {
                alert('Belum ada lembar latihan dari guru.');
                return;
              }
              var saved = doc.data().content;
              var blob = new Blob([saved], {type:'text/plain'});
              var a = document.createElement('a');
              a.href = URL.createObjectURL(blob);
              a.download = 'lembar_latihan_guru.txt';
              a.click();
            });
        };
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ...existing code...

      // Materi logic: open materi and upload
      var materiBtns = document.querySelectorAll('.open-materi');
      var materiPage = document.getElementById('materiPage');
      var materiDetail = document.getElementById('materiDetail');
      var uploadForm = document.getElementById('uploadForm');
      var uploadedFiles = document.getElementById('uploadedFiles');
      var uploadedList = [];

      materiBtns.forEach(function(btn){
        btn.onclick = function(){
          var subject = btn.getAttribute('data-subject');
          var subjectText = subject === 'math' ? 'Matematika' : subject === 'indo' ? 'Bahasa Indonesia' : 'IPA';
          let moduleLinks = '';
          if(subject === 'math') {
            moduleLinks = `
              <ul>
                <li><a href='https://www.ruangguru.com/blog/materi-matematika-sd' target='_blank'>Materi Matematika SD - Ruangguru</a></li>
                <li><a href='https://www.scribd.com/document/456789012/Modul-Matematika-SD-Kelas-4' target='_blank'>Modul Matematika Kelas 4 PDF (Scribd)</a></li>
                <li><a href='https://www.slideshare.net/aguswahyudi/materi-matematika-sd-kelas-4' target='_blank'>Materi Matematika SD Kelas 4 - Slideshare</a></li>
              </ul>
            `;
          } else if(subject === 'indo') {
            moduleLinks = `
              <ul>
                <li><a href='https://www.ruangguru.com/blog/materi-bahasa-indonesia-sd' target='_blank'>Materi Bahasa Indonesia SD - Ruangguru</a></li>
                <li><a href='https://www.scribd.com/document/456789013/Modul-Bahasa-Indonesia-SD-Kelas-4' target='_blank'>Modul Bahasa Indonesia Kelas 4 PDF (Scribd)</a></li>
                <li><a href='https://www.slideshare.net/aguswahyudi/materi-bahasa-indonesia-sd-kelas-4' target='_blank'>Materi Bahasa Indonesia SD Kelas 4 - Slideshare</a></li>
              </ul>
            `;
          } else if(subject === 'sci') {
            moduleLinks = `
              <ul>
                <li><a href='https://www.ruangguru.com/blog/materi-ipa-sd' target='_blank'>Materi IPA SD - Ruangguru</a></li>
                <li><a href='https://www.scribd.com/document/456789014/Modul-IPA-SD-Kelas-4' target='_blank'>Modul IPA Kelas 4 PDF (Scribd)</a></li>
                <li><a href='https://www.slideshare.net/aguswahyudi/materi-ipa-sd-kelas-4' target='_blank'>Materi IPA SD Kelas 4 - Slideshare</a></li>
              </ul>
            `;
          }
          if(materiDetail){
            materiDetail.innerHTML = `<h3>${subjectText}</h3>
              <p>Modul materi valid untuk ${subjectText}:</p>
              ${moduleLinks}
              <p><a href='https://www.google.com/search?q=materi+${encodeURIComponent(subjectText.toLowerCase())}+sd' target='_blank' style='color:#2196f3;text-decoration:underline'>Cari materi lain di Google</a></p>`;
          }
          if(materiPage){
            materiPage.style.display = 'block';
            materiPage.scrollIntoView({behavior:'smooth'});
          }
        };
      });

      if(uploadForm && uploadedFiles){
        uploadForm.onsubmit = function(e){
          e.preventDefault();
          var fileInput = document.getElementById('modulFile');
          var status = document.getElementById('uploadStatus');
          if(fileInput.files.length > 0){
            var file = fileInput.files[0];
            uploadedList.push(file.name);
            status.textContent = 'File berhasil diupload: ' + file.name;
            uploadedFiles.innerHTML = '<b>File Materi Anda:</b><ul>' + uploadedList.map(f => `<li>${f}</li>`).join('') + '</ul>';
            fileInput.value = '';
          } else {
            status.textContent = 'Pilih file terlebih dahulu.';
          }
        };
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var latihanMenu = document.getElementById('latihanMenu');
      var materiMenu = document.querySelector('nav a[href="#materi"]');
      var kuisMenu = document.querySelector('nav a[href="#kuis"]');
      var worksheetCard = document.getElementById('worksheet-card');
      var homeSection = document.getElementById('home');
      var materiSection = document.querySelector('.lessons');
      var kuisSection = document.getElementById('kuis');

      function hideAllSections() {
        if (homeSection) homeSection.style.display = 'none';
        if (worksheetCard) worksheetCard.style.display = 'none';
        if (materiSection) materiSection.style.display = 'none';
        if (kuisSection) kuisSection.style.display = 'none';
      }

      if (latihanMenu && worksheetCard) {
        latihanMenu.addEventListener('click', function(e) {
          e.preventDefault();
          hideAllSections();
          worksheetCard.style.display = 'block';
          worksheetCard.scrollIntoView({behavior:'smooth'});
        });
      }
      if (materiMenu && materiSection) {
        materiMenu.addEventListener('click', function(e) {
          e.preventDefault();
          hideAllSections();
          materiSection.style.display = 'block';
          materiSection.scrollIntoView({behavior:'smooth'});
        });
      }
      if (kuisMenu && kuisSection) {
        kuisMenu.addEventListener('click', function(e) {
          e.preventDefault();
          hideAllSections();
          kuisSection.style.display = 'block';
          kuisSection.scrollIntoView({behavior:'smooth'});
        });
      }
    });
  </script>
</body>
</html>
